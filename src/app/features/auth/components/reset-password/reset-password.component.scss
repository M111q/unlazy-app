@use "../../../../../styles/variables" as vars;
@use "../../../../../styles/mixins" as mixins;

// =============================================================================
// RESET PASSWORD COMPONENT
// =============================================================================
// Extends auth form patterns with specific reset password features

.reset-password-component {
  width: 100%;
  max-width: 400px;
  margin: 0 auto;
}

// =============================================================================
// RESET PASSWORD FORM
// =============================================================================
.reset-password-form {
  width: 100%;

  .form-row {
    margin-bottom: vars.$spacing-sm;

    &:last-of-type {
      margin-bottom: vars.$spacing-md;
    }
  }

  .full-width {
    width: 100%;
  }

  // =============================================================================
  // MATERIAL FORM FIELD OVERRIDES
  // =============================================================================
  .mat-mdc-form-field {
    width: 100%;

    .mat-mdc-form-field-subscript-wrapper {
      margin-top: vars.$spacing-xs;
    }

    // Icon styling
    .mat-mdc-form-field-icon-prefix,
    .mat-mdc-form-field-icon-suffix {
      color: vars.$text-secondary;
      transition: vars.$transition-default;
    }

    // Error state
    &.mat-form-field-invalid {
      .mat-mdc-form-field-icon-prefix {
        color: vars.$color-error;
      }
    }

    // Focus state
    &.mat-focused {
      .mat-mdc-form-field-icon-prefix {
        color: vars.$color-primary;
      }
    }
  }

  // =============================================================================
  // INPUT FIELD STYLING
  // =============================================================================
  .mat-mdc-input-element {
    font-size: vars.$font-size-base;
    line-height: vars.$line-height-relaxed;
    font-family: vars.$font-primary;

    &::placeholder {
      color: vars.$text-hint;
      opacity: 1;
    }

    // Prevent zoom on mobile devices
    @include mixins.media-max(tablet) {
      font-size: vars.$font-size-base;
    }
  }
}

// =============================================================================
// HELP TEXT SECTION
// =============================================================================
@mixin help-text-base {
  margin: vars.$spacing-md 0;
  padding: vars.$spacing-sm;
  background-color: rgba(vars.$color-info, 0.04);
  border-radius: vars.$border-radius-md;
  border-left: vars.$border-width-thick solid vars.$color-info;
}

.help-text {
  @include help-text-base;

  .help-item {
    display: flex;
    align-items: flex-start;
    gap: vars.$spacing-xs;
    margin-bottom: vars.$spacing-xs;

    &:last-child {
      margin-bottom: 0;
    }

    .help-icon {
      font-size: vars.$font-size-xl;
      width: vars.$font-size-xl;
      height: vars.$font-size-xl;
      color: vars.$color-info;
      margin-top: 2px;
      flex-shrink: 0;
    }

    .help-description {
      @include mixins.typography(
        vars.$font-size-sm,
        vars.$font-weight-regular,
        vars.$line-height-normal
      );
      color: vars.$text-secondary;
      margin: 0;
    }
  }

  @include mixins.media-max(tablet) {
    @include mixins.responsive-padding(vars.$spacing-xs, vars.$spacing-sm);

    .help-item {
      gap: vars.$spacing-xs;
      margin-bottom: vars.$spacing-xs;

      .help-icon {
        font-size: vars.$font-size-lg;
        width: vars.$font-size-lg;
        height: vars.$font-size-lg;
      }

      .help-description {
        font-size: vars.$font-size-xs;
      }
    }
  }
}

// =============================================================================
// SUCCESS STATE
// =============================================================================
.success-state {
  .success-message {
    margin-bottom: vars.$spacing-lg;

    .success-text {
      @include mixins.typography(
        vars.$font-size-base,
        vars.$font-weight-medium,
        vars.$line-height-relaxed
      );
      color: vars.$text-primary;
      margin: 0 0 vars.$spacing-xs 0;

      @include mixins.media-max(tablet) {
        font-size: vars.$font-size-sm;
      }
    }

    .success-hint {
      @include mixins.typography(
        vars.$font-size-sm,
        vars.$font-weight-regular,
        vars.$line-height-normal
      );
      color: vars.$text-secondary;
      margin: 0;

      @include mixins.media-max(tablet) {
        font-size: vars.$font-size-xs;
      }
    }
  }

  .success-actions {
    .resend-button {
      display: inline-flex;
      align-items: center;
      gap: vars.$spacing-xs;
      padding: vars.$spacing-xs vars.$spacing-sm;
      border-radius: vars.$border-radius-sm !important;
      text-transform: none !important;
      font-weight: vars.$font-weight-medium;
      transition: vars.$transition-default;
      color: vars.$color-primary;

      .mat-icon {
        font-size: vars.$font-size-lg;
        width: vars.$font-size-lg;
        height: vars.$font-size-lg;
      }

      &:hover:not([disabled]) {
        background-color: rgba(vars.$color-primary, 0.08);
      }

      &:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        color: vars.$text-disabled;
      }

      @include mixins.focus-visible(vars.$color-primary);
    }
  }

  @include mixins.media-max(tablet) {
    padding: vars.$spacing-md 0;

    .success-message {
      margin-bottom: vars.$spacing-md;
    }
  }
}

// =============================================================================
// AUTH DIVIDER
// =============================================================================
.auth-divider {
  text-align: center;
  margin: vars.$spacing-md 0;
  position: relative;
  color: vars.$text-secondary;
  @include mixins.typography(vars.$font-size-sm);

  &::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: vars.$border-width-thin;
    background: vars.$border-color-medium;
  }

  span {
    background: rgba(vars.$color-white, 0.98);
    padding: 0 vars.$spacing-sm;
    position: relative;
    z-index: 1;
    font-weight: vars.$font-weight-regular;
  }

  @include mixins.media-max(tablet) {
    margin: vars.$spacing-md 0;
    font-size: vars.$font-size-xs;

    span {
      padding: 0 vars.$spacing-xs;
    }
  }
}

// =============================================================================
// ACCESSIBILITY ENHANCEMENTS
// =============================================================================
@include mixins.reduced-motion {
  .success-state .success-actions .resend-button {
    transition: none;
  }

  .mat-mdc-form-field-icon-prefix,
  .mat-mdc-form-field-icon-suffix {
    transition: none;
  }
}

// =============================================================================
// HIGH CONTRAST SUPPORT
// =============================================================================
@include mixins.high-contrast {
  .help-text {
    background-color: vars.$color-white;
    border: vars.$border-width-medium solid vars.$color-info;
  }

  .auth-divider {
    &::before {
      background: vars.$text-primary;
      height: vars.$border-width-medium;
    }
  }

  .success-state .success-actions .resend-button {
    border: vars.$border-width-thin solid vars.$color-primary;
  }
}

// =============================================================================
// PRINT STYLES
// =============================================================================
@media print {
  .reset-password-component {
    .success-state .success-actions,
    .help-text,
    .auth-divider {
      display: none;
    }

    .success-state .success-message {
      border: vars.$border-width-thin solid vars.$color-black;
      padding: vars.$spacing-sm;
    }
  }
}

// =============================================================================
// DARK THEME SUPPORT
// =============================================================================
@media (prefers-color-scheme: dark) {
  .help-text {
    background-color: rgba(vars.$color-info, 0.15);
    border-color: rgba(vars.$color-info, 0.5);

    .help-description {
      color: vars.$text-secondary-dark;
    }
  }

  .success-state {
    .success-text {
      color: vars.$text-primary-dark;
    }

    .success-hint {
      color: vars.$text-secondary-dark;
    }

    .success-actions .resend-button {
      color: vars.$color-info-light;

      &:hover:not([disabled]) {
        background-color: rgba(vars.$color-info, 0.15);
      }

      &:disabled {
        color: vars.$text-disabled-dark;
      }
    }
  }

  .auth-divider {
    color: vars.$text-secondary-dark;

    span {
      background: vars.$color-gray-800;
    }

    &::before {
      background: vars.$border-color-medium;
    }
  }

  .mat-mdc-form-field {
    .mat-mdc-form-field-icon-prefix,
    .mat-mdc-form-field-icon-suffix {
      color: vars.$text-secondary-dark;
    }

    &.mat-form-field-invalid {
      .mat-mdc-form-field-icon-prefix {
        color: vars.$color-error-light;
      }
    }

    &.mat-focused {
      .mat-mdc-form-field-icon-prefix {
        color: vars.$color-primary-light;
      }
    }
  }

  .mat-mdc-input-element {
    &::placeholder {
      color: vars.$text-disabled-dark;
    }
  }
}
